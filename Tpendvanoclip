local player = game.Players.LocalPlayer
local RunService = game:GetService("RunService")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local Camera = workspace.CurrentCamera
local teleportEvent = ReplicatedStorage:WaitForChild("TeleportRequest")

local noclip = false
local lockNPC = false
local npc = workspace:FindFirstChild("TargetNPC")

-- Ti·∫øp n·ªëi GUI c·ªßa b·∫°n...
-- (GUI, frame, title ƒë√£ ƒë∆∞·ª£c b·∫°n t·∫°o tr∆∞·ªõc)

-- H√†m t·∫°o n√∫t
local function createButton(text, posY, callback)
	local button = Instance.new("TextButton")
	button.Size = UDim2.new(1, -20, 0, 40)
	button.Position = UDim2.new(0, 10, 0, posY)
	button.BackgroundColor3 = Color3.fromRGB(50, 50, 60)
	button.TextColor3 = Color3.new(1, 1, 1)
	button.Font = Enum.Font.Gotham
	button.TextSize = 20
	button.Text = text
	button.Parent = frame
	button.MouseButton1Click:Connect(callback)
end

-- N√∫t: Teleport to End
createButton("üìç Teleport to End", 60, function()
	teleportEvent:FireServer()
end)

-- N√∫t: Toggle NoClip
createButton("üåÄ Toggle NoClip", 110, function()
	noclip = not noclip
end)

-- N√∫t: Lock on NPC
createButton("üéØ Lock on NPC", 160, function()
	lockNPC = not lockNPC
	if not lockNPC then
		local humanoid = player.Character and player.Character:FindFirstChild("Humanoid")
		if humanoid then
			Camera.CameraSubject = humanoid
		end
	end
end)

-- NoClip & NPC Lock ho·∫°t ƒë·ªông
RunService.Stepped:Connect(function()
	if noclip and player.Character then
		for _, part in ipairs(player.Character:GetDescendants()) do
			if part:IsA("BasePart") then
				part.CanCollide = false
			end
		end
	end

	if lockNPC and npc and npc:FindFirstChild("Humanoid") then
		Camera.CameraSubject = npc.Humanoid
	end
end)
	button.Text = text
	button.Parent = frame
	button.MouseButton1Click:Connect(callback)
end

-- T·∫°o c√°c n√∫t ch√≠nh
createButton("üìç Teleport to End", 10, function()
	teleportEvent:FireServer()
end)

createButton("üåÄ Toggle NoClip", 60, function()
	noclip = not noclip
end)

createButton("üéØ Lock on NPC", 110, function()
	npcLock = not npcLock
	if not npcLock then
		local humanoid = player.Character and player.Character:FindFirstChild("Humanoid")
		if humanoid then Camera.CameraSubject = humanoid end
	end
end)

-- N√∫t Toggle Menu
local toggleBtn = Instance.new("TextButton")
toggleBtn.Size = UDim2.new(0, 140, 0, 40)
toggleBtn.Position = UDim2.new(0, 10, 1, -50)
toggleBtn.BackgroundColor3 = Color3.fromRGB(90, 90, 90)
toggleBtn.TextColor3 = Color3.new(1,1,1)
toggleBtn.Text = "üîß Show/Hide Menu"
toggleBtn.Font = Enum.Font.SourceSansBold
toggleBtn.TextSize = 18
toggleBtn.Parent = gui

toggleBtn.MouseButton1Click:Connect(function()
	guiVisible = not guiVisible
	frame.Visible = guiVisible
end)

-- Noclip + NPC Lock loop
RunService.Stepped:Connect(function()
	if noclip and player.Character then
		for _, part in ipairs(player.Character:GetDescendants()) do
			if part:IsA("BasePart") then
				part.CanCollide = false
			end
		end
	end

	if npcLock and npc and npc:FindFirstChild("Humanoid") then
		Camera.CameraSubject = npc.Humanoid
	end
end)
